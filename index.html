<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>shop</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
	<style>
		@import url('https://fonts.googleapis.com/css?family=Montserrat:wght@200;500&display=swap')
		* {
			box-sizing: border-box;
		}
		body {
			font-family: 'Montserrat', sans-serif;
			font-weight: 200;
			color: var(--tg-theme-text-color);
			background: var(--tg-theme-bg-color);
		}
		#main {
			text-align: center;
		}
		h1 {
			margin-top: 50px;
			margin-bottom: 10px;
		}
		img {
			width: 70px;
			margin: 30px auto;
		}
		p {
			width: 350px;
			margin: auto;
		}
		button {
			border: 0;
			border-radius: 5px;
			margin-top: 50px;
			height: 60px;
			width: 200px;
			font-size: 20px;
			font-weight: 500;
			cursor: pointer;
			transition: all 0.5s ease;
			color: var(--tg-theme-button-color);
			background: var(--tg-theme-button-text-color);
		}
		button:hover {
			background: var(--tg-theme-secondary-bg-color);
		}
		#form {
			display: none;
			text-align: center;
		}
		#form_ind {
			display: none;
			text-align: center;
		}
		.form_radio_group {
			display: inline-block;
			overflow: hidden;
		}
		.form_radio_group-item {
			display: inline-block;
			float: left;    
		}
		.form_radio_group input[type=radio] {
			display: none;
		}
		.form_radio_group label {
			display: inline-block;
			cursor: pointer;
			padding: 0px 4vw;
			line-height: 34px;
			margin-top: 2px;
			border: 1px solid #999;
			border-right: none;
			user-select: none;
		}
		.form_radio_group .form_radio_group-item:first-child label {
			border-radius: 6px 0 0 6px;
		}
		.form_radio_group .form_radio_group-item:last-child label {
			border-radius: 0 6px 6px 0;
			border-right: 1px solid #999;
		}
		.form_radio_group input[type=radio]:checked + label {
			background: #ffe0a6;
		}
		.input_text {
			outline: none;
			padding: 15px 10px;
			font-size: 14px;
			border: 2px solid silver;
			border-radius: 5px;
			margin-top: 2px;
		}
		.input_text input:focus {
			display: none;
		}
	</style>
</head>
<body>
	<div id="main">
		<h1>ServiceName</h1>
		<img src="data/box_icon.png">
		<p>Как заказать товар из Китая без посредников и наценок? Да хуй его знает, сам не ебу, если честно.</p>
		<button id="buy">Заказать</button>
		<button id="buy_ind">Индивидуальный заказ</button>
	</div>
	<form id="form" class="container">
		<img src="data/order_icon.png">
		<br>
		<div class="">
			<h3 style="">Выберите сервис:</h3>
			<div class="form_radio_group">
				<div class="form_radio_group-item">
					<input id="radio-1" type="radio" name="order_from" value="TaoBao">
					<label for="radio-1">TaoBao</label>
				</div>
				<div class="form_radio_group-item">
					<input id="radio-2" type="radio" name="order_from" value="Poizon">
					<label for="radio-2">Poizon</label>
				</div>
				<div class="form_radio_group-item">
					<input id="radio-3" type="radio" name="order_from" value="Xiaomi">
					<label for="radio-3">Xiaomi</label>
				</div>
			</div>
		</div>
		<br>
		<div class="container">
			<h3 style="">Ссылка на заказ:</h3>
			<div class="row">
				<input class="input_text col-9" type="text" placeholder="Введите ссылку на товар" id="order_link">
				<input class="input_text col" type="number" min="1" placeholder="Количество" id="order_link_count">
			</div>
			<div class="row">
				<input class="input_text col-9" style="display: none;" type="text" placeholder="Добавьте еще" id="order_link_2">
				<input class="input_text col" style="display: none;" type="number" min="1" placeholder="Количество" id="order_link_2_count">
			</div>
			<div class="row">
				<input style="display: none;" class="input_text col-9" type="text" placeholder="Добавьте еще" id="order_link_3">
				<input style="display: none;" class="input_text col" type="number" min="1" placeholder="Количество" id="order_link_3_count">
			</div>
			<div class="row">
				<input style="display: none;" class="input_text col-9" type="text" placeholder="Добавьте еще" id="order_link_4">
				<input style="display: none;" class="input_text col" type="number" min="1" placeholder="Количество" id="order_link_4_count">
			</div>
			<div class="row">
				<input style="display: none;" class="input_text col-9" type="text" placeholder="Добавьте еще" id="order_link_5">
				<input style="display: none;" class="input_text col" type="number" min="1" placeholder="Количество" id="order_link_5_count">
			</div>
		</div>
		<br>
		<div class="">
			<h3 style="">Ваше ФИО:</h3>
			<input class="input_text col-12" type="text" placeholder="Фамилия Имя Отчество" id="order_name">
		</div>
		<br>
		<div class="">
			<h3 style="">Ваш город:</h3>
			<input class="input_text col-12" type="text" placeholder="Город" id="order_city">
		</div>
		<br>
		<div class="">
			<h3 style="">Ваш адрес:</h3>
			<input class="input_text col-12" type="text" placeholder="Улица, дом" id="order_address">
		</div>
		<br>
		<div class="">
			<h3 style="">Комментарий к заказу:</h3>
			<input class="input_text col-12" type="text" placeholder="Комментарий, например, ваш телефон" id="order_comment">
		</div>
		<p id="error" style="color: red;"></p>
		<br><br>
		<div class="row">
			<button type="button" class="col" id="order">Оформить заказ</button>
			<button type="button" class="col" data-bs-toggle="modal" data-bs-target="#calculator">Калькулятор</button>
		</div>
	</form>
	<form id="form_ind" class="container">
		<img src="data/order_icon.png">
		<br>
		<div class="">
			<h3 style="">Подробно опишите товар:</h3>
			<input class="input_text col-12" type="text" placeholder="Ссылка, количество и прочая информация" id="order_ind_about">
		</div>
		<br>
		<div class="">
			<h3 style="">Ссылка на пример:</h3>
			<input class="input_text col-12" type="text" placeholder="Ссылка на пример либо картинку на фотохостинге" id="order_ind_link">
		</div>
		<br>
		<div class="">
			<h3 style="">Номер для связи:</h3>
			<input class="input_text col-12" type="text" placeholder="Номер телефона" id="order_ind_phone">
		</div>
		<p id="error_ind" style="color: red;"></p>
		<br><br>
		<div class="row">
			<button type="button" class="col" id="order_ind">Оформить заказ</button>
		</div>
	</form>
	<div class="modal fade" id="calculator" tabindex="-1" aria-labelledby="calculator_label" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="calculator_label" style="color: black;">Калькулятор</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="row">
						<input class="input_text col" type="number" placeholder="Вес (КГ)" min="0" step=0.1 id="calculator_mass">
						<input class="input_text col" type="number" placeholder="Цена CNY" min="1" id="calculator_price">
					</div>
					<br>
					<h2 id="calculator_result_text" style="display: none; color: black;"></h2>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-primary col" id="calculator_result">Посчитать</button>
				</div>
			</div>
		</div>
	</div>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
	<script src="https://telegram.org/js/telegram-web-app.js"></script>
	<script>
		document.getElementById("error").innerText = "";
		let tg = window.Telegram.WebApp;
		let buy = document.getElementById("buy");
		let buy_ind = document.getElementById("buy_ind");
		let order = document.getElementById("order");
		let order_ind = document.getElementById("order_ind");
		let calculator = document.getElementById("calculator_result");
		let type = null
		const kg_cost = 500;
		const CNY_to_RUB_exc = 13;
		tg.expand();

		buy.addEventListener("click", () => {
			document.getElementById("main").style.display = "none";
			document.getElementById("form").style.display = "block";
			type = 0
		})

		buy_ind.addEventListener("click", () => {
			document.getElementById("main").style.display = "none";
			document.getElementById("form_ind").style.display = "block";
			type = 1
		})

		calculator.addEventListener("click", () => {
			price = parseInt(document.getElementById("calculator_price").value);
			mass = parseInt(document.getElementById("calculator_mass").value);
			if (([null, NaN, 0].includes(price)) || ([null, NaN, 0].includes(mass))) {
				return
			}
			result = document.getElementById("calculator_result_text");
			result.innerText = String((price * CNY_to_RUB_exc) + (mass * kg_cost)) + " RUB";
			result.style.display = "block";
		});

		let order_elem = null;
		order_link.addEventListener("input", () => {
			order_elem = [document.getElementById("order_link_2"), document.getElementById("order_link_2_count")];
		});
		order_link_2.addEventListener("input", () => {
			order_elem = [document.getElementById("order_link_3"), document.getElementById("order_link_3_count")];
		});
		order_link_3.addEventListener("input", () => {
			order_elem = [document.getElementById("order_link_4"), document.getElementById("order_link_4_count")];
		});
		order_link_4.addEventListener("input", () => {
			order_elem = [document.getElementById("order_link_5"), document.getElementById("order_link_5_count")];
		});
		document.addEventListener("input", () => {
			if (order_elem != null) {
				for (let i = 0; i < 2; i++) {
					order_elem[i].style.display = "inline-block"
				}
				order_elem = null
			};
		});

		order.addEventListener("click", () => {
			let order_from = ""
			if (document.getElementById("radio-1").checked == true) {
				order_from = "TaoBao";
			}
			if (document.getElementById("radio-2").checked == true) {
				order_from = "Poizon";
			}
			if (document.getElementById("radio-3").checked == true) {
				order_from = "Xiaomi";
			}
			let order_link = [document.getElementById("order_link").value, document.getElementById("order_link_2").value, document.getElementById("order_link_3").value, document.getElementById("order_link_4").value, document.getElementById("order_link_5").value]
			let order_link_count = [document.getElementById("order_link_count").value, document.getElementById("order_link_2_count").value, document.getElementById("order_link_3_count").value, document.getElementById("order_link_4_count").value, document.getElementById("order_link_5_count").value]
			let order_name = document.getElementById("order_name").value;
			let order_city = document.getElementById("order_city").value;
			let order_address = document.getElementById("order_address").value;
			let order_comment = document.getElementById("order_comment").value;

			if (order_from.length < 1) {
				document.getElementById("error").innerText = "\n\nВы не выбрали сервис.";
				return
			};
			if (order_link.length < 1) {
				document.getElementById("error").innerText = "\n\nВы не вставили ссылку на товар.";
				return
			};
			if (order_link_count.length < 1) {
				document.getElementById("error").innerText = "\n\nВы не выбрали количество товара.";
				return
			};
			if (order_name.length < 1) {
				document.getElementById("error").innerText = "\n\nВы не написали ФИО.";
				return
			};
			if (order_city.length < 1) {
				document.getElementById("error").innerText = "\n\nВы не указали свой город.";
				return
			};
			if (order_address.length < 1) {
				document.getElementById("error").innerText = "\n\nВы не указали свой адрес.";
				return
			};
			let data = {
				order_from: order_from,
				order_link: order_link,
				order_name: order_name,
				order_city: order_city,
				order_address: order_address,
				order_link_count: order_link_count,
				order_comment: order_comment,
				order_type: 0,
			}
			tg.sendData(JSON.stringify(data));
			tg.close();
		});

		order_ind.addEventListener("click", () => {
			let order_ind_about = document.getElementById("order_ind_about").value;
			let order_ind_link = document.getElementById("order_ind_link").value;
			let order_ind_phone = document.getElementById("order_ind_phone").value;

			if (order_ind_about.length < 1) {
				document.getElementById("error_ind").innerText = "\n\nВы не написали информацию.";
				return
			};
			if (order_ind_link.length < 1) {
				document.getElementById("error_ind").innerText = "\n\nВы не указали пример.";
				return
			};
			if (order_ind_link.length < 1) {
				document.getElementById("error_ind").innerText = "\n\nВы не указали телефон для связи.";
				return
			};
			let data = {
				order_ind_about: order_ind_about,
				order_ind_link: order_ind_link,
				order_ind_phone: order_ind_phone,
				order_type: 1,
			}
			tg.sendData(JSON.stringify(data));
			tg.close();
		});
	</script>
</body>
</html>
